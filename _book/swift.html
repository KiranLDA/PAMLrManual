<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>11 Classify flap-glide | PAMLr Manual</title>
  <meta name="description" content="11 Classify flap-glide | PAMLr Manual">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="11 Classify flap-glide | PAMLr Manual" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="11 Classify flap-glide | PAMLr Manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Classify flap-glide | PAMLr Manual" />
  
  <meta name="twitter:description" content="11 Classify flap-glide | PAMLr Manual" />
  

<meta name="author" content="Kiran Dhanjal-Adams">


<meta name="date" content="2019-04-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="soar.html">
<link rel="next" href="outook.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/dygraphs-1.1.1/shapes.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.19/rglWebGL.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PAMLr Manuals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#index"><i class="fa fa-check"></i><b>1.1</b> Index</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#package-citation"><i class="fa fa-check"></i><b>1.2</b> Package citation</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>2</b> Installing PAMLr</a><ul>
<li class="chapter" data-level="2.1" data-path="install.html"><a href="install.html#prerequisites"><i class="fa fa-check"></i><b>2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="2.2" data-path="install.html"><a href="install.html#installing"><i class="fa fa-check"></i><b>2.2</b> Installing</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>3</b> Importing data</a><ul>
<li class="chapter" data-level="3.1" data-path="import.html"><a href="import.html#load-pamlr"><i class="fa fa-check"></i><b>3.1</b> Load PAMLr</a></li>
<li class="chapter" data-level="3.2" data-path="import.html"><a href="import.html#use-existing-data"><i class="fa fa-check"></i><b>3.2</b> Use existing data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="import.html"><a href="import.html#hoopoe-upupa-epops"><i class="fa fa-check"></i><b>3.2.1</b> Hoopoe (<em>Upupa epops</em>)</a></li>
<li class="chapter" data-level="3.2.2" data-path="import.html"><a href="import.html#european-bee-eater-merops-apiaster"><i class="fa fa-check"></i><b>3.2.2</b> European Bee-eater (<em>Merops apiaster</em>)</a></li>
<li class="chapter" data-level="3.2.3" data-path="import.html"><a href="import.html#alpine-swift-apus-melba"><i class="fa fa-check"></i><b>3.2.3</b> Alpine Swift (<em>Apus melba</em>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="import.html"><a href="import.html#import-your-own-data"><i class="fa fa-check"></i><b>3.3</b> Import your own data</a></li>
<li class="chapter" data-level="3.4" data-path="import.html"><a href="import.html#data-details"><i class="fa fa-check"></i><b>3.4</b> Data details</a></li>
<li class="chapter" data-level="3.5" data-path="import.html"><a href="import.html#temporal-resolution-of-data"><i class="fa fa-check"></i><b>3.5</b> Temporal resolution of data</a></li>
<li class="chapter" data-level="3.6" data-path="import.html"><a href="import.html#cropping-the-data"><i class="fa fa-check"></i><b>3.6</b> Cropping the data</a></li>
<li class="chapter" data-level="3.7" data-path="import.html"><a href="import.html#table-references"><i class="fa fa-check"></i><b>3.7</b> Table references</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>4</b> Data Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="dataviz.html"><a href="dataviz.html#formatting-data"><i class="fa fa-check"></i><b>4.1</b> Formatting data</a></li>
<li class="chapter" data-level="4.2" data-path="dataviz.html"><a href="dataviz.html#quick-multiplots"><i class="fa fa-check"></i><b>4.2</b> Quick multiplots</a></li>
<li class="chapter" data-level="4.3" data-path="dataviz.html"><a href="dataviz.html#interactive-timeseries"><i class="fa fa-check"></i><b>4.3</b> Interactive timeseries</a></li>
<li class="chapter" data-level="4.4" data-path="dataviz.html"><a href="dataviz.html#sensor-images"><i class="fa fa-check"></i><b>4.4</b> Sensor images</a></li>
<li class="chapter" data-level="4.5" data-path="dataviz.html"><a href="dataviz.html#histograms-and-three-dimensional-scatterplots"><i class="fa fa-check"></i><b>4.5</b> Histograms and three-dimensional scatterplots</a></li>
<li class="chapter" data-level="4.6" data-path="dataviz.html"><a href="dataviz.html#spherical-projections"><i class="fa fa-check"></i><b>4.6</b> Spherical projections</a><ul>
<li class="chapter" data-level="4.6.1" data-path="dataviz.html"><a href="dataviz.html#g-sphere"><i class="fa fa-check"></i><b>4.6.1</b> g-sphere</a></li>
<li class="chapter" data-level="4.6.2" data-path="dataviz.html"><a href="dataviz.html#m-sphere"><i class="fa fa-check"></i><b>4.6.2</b> m-sphere</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="patterns.html"><a href="patterns.html"><i class="fa fa-check"></i><b>5</b> Common data patterns</a><ul>
<li class="chapter" data-level="5.0.1" data-path="patterns.html"><a href="patterns.html#migration"><i class="fa fa-check"></i><b>5.0.1</b> Migration</a></li>
<li class="chapter" data-level="5.0.2" data-path="patterns.html"><a href="patterns.html#flap-gliding-birds"><i class="fa fa-check"></i><b>5.0.2</b> <em>Flap-gliding birds</em></a></li>
<li class="chapter" data-level="5.0.3" data-path="patterns.html"><a href="patterns.html#soar-gliding-birds"><i class="fa fa-check"></i><b>5.0.3</b> <em>Soar-gliding birds</em></a></li>
<li class="chapter" data-level="5.1" data-path="patterns.html"><a href="patterns.html#incubation"><i class="fa fa-check"></i><b>5.1</b> Incubation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dataprep.html"><a href="dataprep.html"><i class="fa fa-check"></i><b>6</b> Preparing data for analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="dataprep.html"><a href="dataprep.html#merge-sensor-data-together"><i class="fa fa-check"></i><b>6.1</b> Merge sensor data together</a><ul>
<li class="chapter" data-level="6.1.1" data-path="dataprep.html"><a href="dataprep.html#interpolation"><i class="fa fa-check"></i><b>6.1.1</b> Interpolation</a></li>
<li class="chapter" data-level="6.1.2" data-path="dataprep.html"><a href="dataprep.html#no-interpolation"><i class="fa fa-check"></i><b>6.1.2</b> No interpolation</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="dataprep.html"><a href="dataprep.html#rolling-window"><i class="fa fa-check"></i><b>6.2</b> Rolling window</a><ul>
<li class="chapter" data-level="6.2.1" data-path="dataprep.html"><a href="dataprep.html#interpolation-1"><i class="fa fa-check"></i><b>6.2.1</b> Interpolation</a></li>
<li class="chapter" data-level="6.2.2" data-path="dataprep.html"><a href="dataprep.html#no-interpolation-1"><i class="fa fa-check"></i><b>6.2.2</b> No interpolation</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="dataprep.html"><a href="dataprep.html#extracting-statistics-for-specific-data-patterns"><i class="fa fa-check"></i><b>6.3</b> Extracting statistics for specific data patterns</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification-methods.html"><a href="classification-methods.html"><i class="fa fa-check"></i><b>7</b> Classification methods</a><ul>
<li class="chapter" data-level="7.1" data-path="classification-methods.html"><a href="classification-methods.html#changepoint"><i class="fa fa-check"></i><b>7.1</b> Changepoint</a></li>
<li class="chapter" data-level="7.2" data-path="classification-methods.html"><a href="classification-methods.html#cluster-analysis"><i class="fa fa-check"></i><b>7.2</b> Cluster Analysis</a><ul>
<li class="chapter" data-level="7.2.1" data-path="classification-methods.html"><a href="classification-methods.html#k-means-clustering"><i class="fa fa-check"></i><b>7.2.1</b> k-means clustering</a></li>
<li class="chapter" data-level="7.2.2" data-path="classification-methods.html"><a href="classification-methods.html#hierarchical-clustering"><i class="fa fa-check"></i><b>7.2.2</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="7.2.3" data-path="classification-methods.html"><a href="classification-methods.html#expectation-minimisation-binary-clustering"><i class="fa fa-check"></i><b>7.2.3</b> Expectation-minimisation binary clustering</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="classification-methods.html"><a href="classification-methods.html#hidden-markov-models"><i class="fa fa-check"></i><b>7.3</b> Hidden Markov Models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="classification-accuracy.html"><a href="classification-accuracy.html"><i class="fa fa-check"></i><b>8</b> Classification accuracy</a><ul>
<li class="chapter" data-level="8.1" data-path="classification-accuracy.html"><a href="classification-accuracy.html#classify-migratory-flapping-flight"><i class="fa fa-check"></i><b>8.1</b> Classify migratory flapping flight</a></li>
<li class="chapter" data-level="8.2" data-path="classification-accuracy.html"><a href="classification-accuracy.html#setup-the-reference-dataset"><i class="fa fa-check"></i><b>8.2</b> Setup the reference dataset</a></li>
<li class="chapter" data-level="8.3" data-path="classification-accuracy.html"><a href="classification-accuracy.html#classify-migration"><i class="fa fa-check"></i><b>8.3</b> Classify migration</a></li>
<li class="chapter" data-level="8.4" data-path="classification-accuracy.html"><a href="classification-accuracy.html#compare-the-two-classifications"><i class="fa fa-check"></i><b>8.4</b> Compare the two classifications</a></li>
<li class="chapter" data-level="8.5" data-path="classification-accuracy.html"><a href="classification-accuracy.html#create-a-confusion-matrix"><i class="fa fa-check"></i><b>8.5</b> Create a confusion Matrix</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="flapping.html"><a href="flapping.html"><i class="fa fa-check"></i><b>9</b> Classifly flapping</a><ul>
<li class="chapter" data-level="9.1" data-path="flapping.html"><a href="flapping.html#classifying-migratory-flapping-flight-in-hoopoes-the-dataset"><i class="fa fa-check"></i><b>9.1</b> Classifying migratory flapping flight in Hoopoes :The dataset</a></li>
<li class="chapter" data-level="9.2" data-path="flapping.html"><a href="flapping.html#visualise-data"><i class="fa fa-check"></i><b>9.2</b> Visualise data</a></li>
<li class="chapter" data-level="9.3" data-path="flapping.html"><a href="flapping.html#what-should-we-look-for"><i class="fa fa-check"></i><b>9.3</b> What should we look for?</a></li>
<li class="chapter" data-level="9.4" data-path="flapping.html"><a href="flapping.html#performing-the-classification"><i class="fa fa-check"></i><b>9.4</b> Performing the classification</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="soar.html"><a href="soar.html"><i class="fa fa-check"></i><b>10</b> Classify soar-gliding</a><ul>
<li class="chapter" data-level="10.1" data-path="soar.html"><a href="soar.html#classifying-migratory-flight-in-european-bee-eaters-the-dataset"><i class="fa fa-check"></i><b>10.1</b> Classifying migratory flight in European bee-eaters: the dataset</a></li>
<li class="chapter" data-level="10.2" data-path="soar.html"><a href="soar.html#visualise-data-1"><i class="fa fa-check"></i><b>10.2</b> Visualise data</a></li>
<li class="chapter" data-level="10.3" data-path="soar.html"><a href="soar.html#what-should-we-look-for-1"><i class="fa fa-check"></i><b>10.3</b> What should we look for?</a></li>
<li class="chapter" data-level="10.4" data-path="soar.html"><a href="soar.html#what-variables-make-the-most-sense-for-classifying"><i class="fa fa-check"></i><b>10.4</b> What variables make the most sense for classifying?</a></li>
<li class="chapter" data-level="10.5" data-path="soar.html"><a href="soar.html#classify-using-hmm"><i class="fa fa-check"></i><b>10.5</b> Classify using HMM</a><ul>
<li class="chapter" data-level="10.5.1" data-path="soar.html"><a href="soar.html#translate-the-classification-events-into-something-usable"><i class="fa fa-check"></i><b>10.5.1</b> <em>Translate the classification events into something usable</em></a></li>
<li class="chapter" data-level="10.5.2" data-path="soar.html"><a href="soar.html#plot-the-classification"><i class="fa fa-check"></i><b>10.5.2</b> <em>Plot the classification</em></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="soar.html"><a href="soar.html#classify-using-pressure"><i class="fa fa-check"></i><b>10.6</b> Classify using pressure</a><ul>
<li class="chapter" data-level="10.6.1" data-path="soar.html"><a href="soar.html#translate-the-classification-events-into-something-usable-1"><i class="fa fa-check"></i><b>10.6.1</b> <em>Translate the classification events into something usable</em></a></li>
<li class="chapter" data-level="10.6.2" data-path="soar.html"><a href="soar.html#plot-the-classification-1"><i class="fa fa-check"></i><b>10.6.2</b> <em>Plot the classification</em></a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="soar.html"><a href="soar.html#classify-using-a-changepoint-analysis"><i class="fa fa-check"></i><b>10.7</b> Classify using a changepoint analysis</a></li>
<li class="chapter" data-level="10.8" data-path="soar.html"><a href="soar.html#compare-the-classifications"><i class="fa fa-check"></i><b>10.8</b> Compare the classifications</a><ul>
<li class="chapter" data-level="10.8.1" data-path="soar.html"><a href="soar.html#plot-the-agreement-between-the-migration-classifications"><i class="fa fa-check"></i><b>10.8.1</b> <em>Plot the agreement between the migration classifications</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="swift.html"><a href="swift.html"><i class="fa fa-check"></i><b>11</b> Classify flap-glide</a><ul>
<li class="chapter" data-level="11.1" data-path="swift.html"><a href="swift.html#classifying-migratory-flight-alpine-swifts-the-dataset"><i class="fa fa-check"></i><b>11.1</b> Classifying migratory flight Alpine swifts: The dataset</a></li>
<li class="chapter" data-level="11.2" data-path="swift.html"><a href="swift.html#visualise-data-2"><i class="fa fa-check"></i><b>11.2</b> Visualise data</a></li>
<li class="chapter" data-level="11.3" data-path="swift.html"><a href="swift.html#what-should-we-look-for-2"><i class="fa fa-check"></i><b>11.3</b> What should we look for?</a><ul>
<li class="chapter" data-level="11.3.1" data-path="swift.html"><a href="swift.html#plot-the-classifiers"><i class="fa fa-check"></i><b>11.3.1</b> Plot the classifiers</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="swift.html"><a href="swift.html#classify-migration-using-a-hidden-markov-model"><i class="fa fa-check"></i><b>11.4</b> Classify migration using a hidden markov model</a></li>
<li class="chapter" data-level="11.5" data-path="swift.html"><a href="swift.html#find-which-state-is-the-migratory-state"><i class="fa fa-check"></i><b>11.5</b> Find which state is the migratory state</a></li>
<li class="chapter" data-level="11.6" data-path="swift.html"><a href="swift.html#plot-the-classification-as-a-sensor-image"><i class="fa fa-check"></i><b>11.6</b> Plot the classification as a sensor image</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="outook.html"><a href="outook.html"><i class="fa fa-check"></i><b>12</b> A few last things to think about</a><ul>
<li class="chapter" data-level="12.1" data-path="outook.html"><a href="outook.html#using-biologically-meaningful-patterns"><i class="fa fa-check"></i><b>12.1</b> Using biologically meaningful patterns</a></li>
<li class="chapter" data-level="12.2" data-path="outook.html"><a href="outook.html#data-resolution-and-interpolation"><i class="fa fa-check"></i><b>12.2</b> Data resolution and interpolation</a></li>
<li class="chapter" data-level="12.3" data-path="outook.html"><a href="outook.html#using-supervised-machine-learning"><i class="fa fa-check"></i><b>12.3</b> Using supervised machine learning</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/KiranLDA/PAMLr" target="_blank">Install PAMLr from github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PAMLr Manual</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="swift" class="section level1">
<h1><span class="header-section-number">11</span> Classify flap-glide</h1>
<div class="figure" style="text-align: center"><span id="fig:appuuuuus"></span>
<img src="https://upload.wikimedia.org/wikipedia/commons/e/ec/Tachymarptis_melba_-Spain_-collage-8.jpg" alt="Photograph by Pau Artigas, (c) creative commons" width="100%" />
<p class="caption">
Figure 11.1: Photograph by Pau Artigas, (c) creative commons
</p>
</div>
<div id="classifying-migratory-flight-alpine-swifts-the-dataset" class="section level2">
<h2><span class="header-section-number">11.1</span> Classifying migratory flight Alpine swifts: The dataset</h2>
<p>Alpine swift (<em>Apus melba</em>) have been tracked on the their migrations from Switzerland to sub-Saharan Africa using SOI-GDL3pam loggers.</p>
<ul>
<li><strong>Pressure</strong> is recorded every 15 minutes</li>
<li><strong>Light</strong> is recorded every 2 minutes</li>
<li><strong>Activity</strong> is recorded every 5 minutes</li>
<li><strong>Pitch</strong> is recorded every 5 minutes</li>
<li><strong>Temperature</strong> is recorded every 15 minutes</li>
<li><strong>Tri-axial acceleration</strong> is recorded every 4 hours</li>
<li><strong>Tri-axial magnetic field</strong> is recorded every 4 hours</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;swift&quot;</span>)

<span class="co"># make sure the cropping period is in the correct date format</span>
start =<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2016-09-01&quot;</span>,<span class="st">&quot;%Y-%m-%d&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;UTC&quot;</span>)
end =<span class="st"> </span><span class="kw">as.POSIXct</span>(<span class="st">&quot;2017-04-10&quot;</span>,<span class="st">&quot;%Y-%m-%d&quot;</span>, <span class="dt">tz=</span><span class="st">&quot;UTC&quot;</span>)

<span class="co"># Crop the data</span>
PAM_data=<span class="st"> </span><span class="kw">cutPAM</span>(swift,start,end)</code></pre></div>
</div>
<div id="visualise-data-2" class="section level2">
<h2><span class="header-section-number">11.2</span> Visualise data</h2>
<p>Sensor images are a good place to start when analysing data, as they can give a rapid overview of the dataset. Darker colors represent lower values, and lighter colors (in this case yellow) represent higher values. Sensor images for <strong>activity</strong> (also known as an actogram), <strong>pitch</strong>, <strong>pressure</strong> and <strong>temperature</strong> are a good place to start. The following code plots this for us:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="co"># number of panels</span>
    <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">6</span>), <span class="co"># outer margin around all panels</span>
    <span class="dt">mar =</span>  <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>)) <span class="co"># inner margin around individual fivure</span>

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>acceleration<span class="op">$</span>date, <span class="dt">ploty=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>acceleration<span class="op">$</span>act, <span class="dt">main =</span> <span class="st">&quot;Activity&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>acceleration<span class="op">$</span>date, <span class="dt">plotx=</span><span class="ot">TRUE</span>, <span class="dt">ploty=</span><span class="ot">FALSE</span>, <span class="dt">labely=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>acceleration<span class="op">$</span>pit,  <span class="dt">main=</span><span class="st">&quot;Pitch&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>pressure<span class="op">$</span>date, <span class="dt">plotx=</span><span class="ot">TRUE</span>, <span class="dt">ploty=</span><span class="ot">FALSE</span>, <span class="dt">labely=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>pressure<span class="op">$</span>obs,  <span class="dt">main=</span><span class="st">&quot;Pressure&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>temperature<span class="op">$</span>date, <span class="dt">labely=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>temperature<span class="op">$</span>obs,  <span class="dt">main=</span><span class="st">&quot;Temperature&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="PAMLrManual_files/figure-html/sensooor3-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="what-should-we-look-for-2" class="section level2">
<h2><span class="header-section-number">11.3</span> What should we look for?</h2>
<p>Some pattern start to stick out.</p>
<ul>
<li><strong>Migration appears very short</strong></li>
<li>The birds are <strong>active all year round</strong></li>
<li>Pressure is <strong>lower during migration</strong> indicating higher altitude flights, <strong>particularly during night</strong></li>
<li>Temperature is <strong>lower during migration</strong> also indicating higher altitudes</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">TOclassify =<span class="st"> </span><span class="kw">rollPAM</span>(PAM_data,
                     <span class="dt">resolution_out =</span> <span class="dv">30</span> ,
                     <span class="dt">window =</span> <span class="dv">24</span><span class="op">*</span><span class="dv">60</span>,
                     <span class="dt">interp =</span> <span class="ot">FALSE</span>)</code></pre></div>
<div id="plot-the-classifiers" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Plot the classifiers</h3>
<p>This helps think about which classifiers show differences for the behaviours we are trying to classify.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># choose variables of interest</span>
varint =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sd_pit&quot;</span>,
           <span class="st">&quot;sd_pressure&quot;</span>,
           <span class="st">&quot;median_temperature&quot;</span>,
           <span class="st">&quot;min_gZ&quot;</span>,
           <span class="st">&quot;max_act&quot;</span>,
           <span class="st">&quot;median_pressure&quot;</span>,
           <span class="st">&quot;median_mY&quot;</span>,
           <span class="st">&quot;sd_mZ&quot;</span>)


<span class="co">#plot these variables of interest</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varint)){
  <span class="kw">plot</span>(TOclassify<span class="op">$</span>date, TOclassify[,varint[i]], 
       <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Date&quot;</span>, <span class="dt">ylab =</span> varint[i])
}</code></pre></div>
<p><img src="PAMLrManual_files/figure-html/unnamed-chunk-69-1.png" width="672" /><img src="PAMLrManual_files/figure-html/unnamed-chunk-69-2.png" width="672" /></p>
</div>
</div>
<div id="classify-migration-using-a-hidden-markov-model" class="section level2">
<h2><span class="header-section-number">11.4</span> Classify migration using a hidden markov model</h2>
<p>One of the most difficult aspects of creating a classification is determining how many classes should be used. Here, we increase the number of classes until the behaviour we want to classify is correcly classified. Once this is done, we can extract this classification from the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select the columns to use as predictors in the model</span>
predictor =<span class="st"> </span>TOclassify[, varint]

<span class="co"># Perform the classification</span>
classification =<span class="st"> </span><span class="kw">classifyPAM</span>(predictor,
                             <span class="dt">states =</span> <span class="dv">7</span>,
                             <span class="dt">method =</span> <span class="st">&quot;hmm&quot;</span>)</code></pre></div>
<pre><code>## converged at iteration 25 with logLik: -405597.7</code></pre>
</div>
<div id="find-which-state-is-the-migratory-state" class="section level2">
<h2><span class="header-section-number">11.5</span> Find which state is the migratory state</h2>
<p>To do this, we find the state where pressure was the lowest, i.e. the bird was at the highest altitude, making the assumption that this is when the bird migrates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#what is the minimum pressure for each class?</span>
minP =<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">unique</span>(classification<span class="op">$</span>cluster)),
       <span class="cf">function</span>(i) <span class="kw">min</span>(TOclassify<span class="op">$</span>median_pressure[classification<span class="op">$</span>cluster<span class="op">==</span>i])))

<span class="co"># which class has the smallest minimum pressure</span>
mig_state =<span class="st"> </span><span class="kw">which</span>(minP <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(minP))

<span class="co"># create a new classification which is just migration, non-migration</span>
mig_classification =<span class="st"> </span><span class="kw">ifelse</span>(classification<span class="op">$</span>cluster <span class="op">==</span><span class="st"> </span>mig_state,<span class="dv">2</span>,<span class="dv">1</span>)</code></pre></div>
</div>
<div id="plot-the-classification-as-a-sensor-image" class="section level2">
<h2><span class="header-section-number">11.6</span> Plot the classification as a sensor image</h2>
<p>Another way of looking at a classification is to use a sensor image of the results and to plot it side by side with the raw data to see if the same patterns are being picked out. We can also add (for instance sunset and sunrise events)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="co"># number of panels</span>
    <span class="dt">oma=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">6</span>), <span class="co"># outer margin around all panels</span>
    <span class="dt">mar =</span>  <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>)) <span class="co"># inner margin around individual fivure</span>

col=<span class="kw">c</span>(<span class="st">&quot;royalblue3&quot;</span>, <span class="st">&quot;orange&quot;</span>)

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>acceleration<span class="op">$</span>date, <span class="dt">ploty=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>acceleration<span class="op">$</span>act, <span class="dt">main =</span> <span class="st">&quot;Activity&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="kw">sensorIMG</span>(PAM_data<span class="op">$</span>pressure<span class="op">$</span>date, <span class="dt">plotx=</span><span class="ot">TRUE</span>, <span class="dt">ploty=</span><span class="ot">FALSE</span>, <span class="dt">labely=</span><span class="ot">FALSE</span>,
          PAM_data<span class="op">$</span>pressure<span class="op">$</span>obs,  <span class="dt">main=</span><span class="st">&quot;Pressure&quot;</span>,
          <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>,viridis<span class="op">::</span><span class="kw">cividis</span>(<span class="dv">90</span>)), <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="kw">sensorIMG</span>(TOclassify<span class="op">$</span>date, <span class="dt">labely=</span><span class="ot">FALSE</span>,
          mig_classification, 
          <span class="dt">main=</span><span class="st">&quot;Classification&quot;</span>,
          <span class="dt">col=</span>col,
          <span class="dt">cex=</span><span class="fl">1.2</span>, <span class="dt">cex.main =</span> <span class="dv">2</span>)

<span class="co"># estimate sunrises and sunsets</span>
twilights &lt;-<span class="st"> </span>GeoLight<span class="op">::</span><span class="kw">twilightCalc</span>(PAM_data<span class="op">$</span>light<span class="op">$</span>date, PAM_data<span class="op">$</span>light<span class="op">$</span>obs,
                                    <span class="dt">LightThreshold =</span> <span class="dv">2</span>, <span class="dt">ask =</span> <span class="ot">FALSE</span>)

<span class="co"># Add sunrises and sunsets</span>
<span class="kw">addTWL</span>(twilights<span class="op">$</span>tFirst,
       <span class="dt">offset=</span><span class="dv">0</span>,
       <span class="dt">col=</span> <span class="kw">ifelse</span>(twilights<span class="op">$</span>type <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,
                   <span class="st">&quot;grey&quot;</span>,<span class="st">&quot;black&quot;</span>),
       <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)</code></pre></div>
<p><img src="PAMLrManual_files/figure-html/unnamed-chunk-72-1.png" width="100%" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="soar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outook.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

</body>

</html>
